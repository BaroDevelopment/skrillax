<?xml version="1.0" encoding="UTF-8" ?>
<packets module="auth">

    <enum name="LogoutMode" type="u8">
        <variation name="Logout" value="1" />
        <variation name="Restart" value="2" />
    </enum>

    <enum name="LogoutResult" type="u8">
        <variation name="Success" value="1">
            <attribute name="seconds_to_logout" type="u32" />
            <attribute name="mode" type="LogoutMode" />
        </variation>
        <variation name="Error" value="2">
            <attribute name="error" type="u16" />
        </variation>
    </enum>

    <enum name="AuthResultError" type="u8">
        <variation name="InvalidData" value="2" />
        <variation name="NotInService" value="3" />
        <variation name="ServerFull" value="4" />
        <variation name="IpLimit" value="5" />
    </enum>

    <enum name="AuthResult" type="u8">
        <variation name="Success" value="1">
            <attribute name="unknown_1" type="u8" value="3" />
            <attribute name="unknown_2" type="u8" value="0" />
        </variation>
        <variation name="Error" value="2">
            <attribute name="code" type="AuthResultError" />
        </variation>
    </enum>

    <packet name="AuthRequest" source="client" opcode="0x6103">
        <attribute name="token" type="u32" />
        <attribute name="username" type="String" />
        <attribute name="password" type="String" />
        <attribute name="unknown" type="u8" />
        <attribute name="mac_bytes" type="raw" length="6" />
    </packet>

    <packet name="AuthResponse" source="server" opcode="0xA103">
        <attribute name="result" type="AuthResult" />
    </packet>

    <packet name="LogoutRequest" source="client" opcode="0x7005">
        <attribute name="mode" type="LogoutMode" />
    </packet>

    <packet name="LogoutResponse" source="server" opcode="0xB005">
        <attribute name="result" type="LogoutResult" />
    </packet>

    <packet name="LogoutFinished" source="server" opcode="0x300A" />
    <packet name="Disconnect" source="server" opcode="0x2212">
        <attribute name="unknown" type="u8" value="0xFF" />
    </packet>
</packets>